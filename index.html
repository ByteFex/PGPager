<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Pgpager by ByteFex</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Pgpager</h1>
        <p>Send and Receive PGP/GPG encrypted SMS messages on Raspberry PI</p>

        <p class="view"><a href="https://github.com/ByteFex/PGPager">View the Project on GitHub <small>ByteFex/PGPager</small></a></p>


        <ul>
          <li><a href="https://github.com/ByteFex/PGPager/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/ByteFex/PGPager/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/ByteFex/PGPager">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="pgpager" class="anchor" href="#pgpager" aria-hidden="true"><span class="octicon octicon-link"></span></a>PGPager</h1>

<p>Send and receive encrypted SMS messages between Raspberry PIs or PGP Smartphone APP and Raspberry PI.</p>

<h2>
<a id="mission" class="anchor" href="#mission" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mission</h2>

<ul>
<li>Encrypt and sign SMS messages on a Raspberry PI using a touch-sensitive display without NSA bullshit (and other backdoors).</li>
<li>Create community to discuss, contribute and review code.</li>
<li>Create a 3D printer casing (including battery) for the RasPi and the display for everyday use. Should not be bigger than a cigarette package.</li>
<li>Create user friendly GUI for everyone.</li>
<li>Have fun sending private messages. </li>
</ul>

<h2>
<a id="intro" class="anchor" href="#intro" aria-hidden="true"><span class="octicon octicon-link"></span></a>Intro</h2>

<p>PGPager is a Python-App for the Raspberry PI initially written by David Darmann at <a href="http://www.ByteFex.com">ByteFex.com</a>
It's designed for a RasPi with the <a href="http://www.adafruit.com/products/1601">Adafruit PiTFT</a> on top.</p>

<p>Its touch screen user interface enables you to send and receive PGP encrypted SMS. You can also manage your PGP keys from the user interface. It's developed and tested with an Huawei E303 UMTS USB-Stick but will possibly also work with other Huawei sticks since their interfaces are quite similar.</p>

<h2>
<a id="tech" class="anchor" href="#tech" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tech</h2>

<p>PGPager uses a number of open source projects to work properly:</p>

<ul>
<li>
<a href="http://www.pygame.org/">pygame</a> - Set of Python modules designed for writing games.</li>
<li>
<a href="https://github.com/wbphelps/VKeyboard">VKeyboard</a> - A Python Virtual Keyboard for Adafruit PiTFT and other touch screen devices</li>
<li>
<a href="https://www.gnupg.org/">GnuPG</a> - Complete and free implementation of the OpenPGP standard</li>
<li>
<a href="https://pythonhosted.org/python-gnupg/">python-gnupg</a> - Python wrapper for GnuPG</li>
<li>
<a href="http://docs.python-requests.org/en/latest/">requests</a> - An Apache2 Licensed HTTP library, written in Python</li>
<li>
<a href="http://www.pygame.org/pcr/text_rect/index.php">textrect</a> - Word-wrapped text display module</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="preparation" class="anchor" href="#preparation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preparation</h3>

<p>I assume that you've got the <a href="http://www.adafruit.com/products/1601">Adafruit PiTFT</a> already working and you can see the text console on the PiTFT. If that's not the case, there is an excellent guide at the <a href="https://learn.adafruit.com/adafruit-pitft-28-inch-resistive-touchscreen-display-raspberry-pi">Adafruit Learning System</a>. You can even find a ready to use kernel image there.</p>

<p>I also assume that you have an ssh connection to your pi. If not, there's also a lot of <a href="http://www.raspberrypi.org/documentation/remote-access/ssh/">tutorials</a> for that.</p>

<p>You can use <a href="https://filezilla-project.org/">FileZilla</a> to copy files to and from your Raspberry PI. You find all the settings <a href="http://www.raspberrypi.org/documentation/remote-access/ssh/sftp.md">here</a>.</p>

<h3>
<a id="configure-huawei-e303" class="anchor" href="#configure-huawei-e303" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure Huawei E303</h3>

<p>This can be quite tricky. When you first plug the UMTS-Stick into your Pi (or any other computer) it will act as a CD drive. But that's not what we want. We want it to act as a network interface to give us internet access. That way we can also use the web interface to send and receive SMS messages.</p>

<p>Plug your E303 into your Pi and type <code>lsusb</code>. This will give you a list of connected usb devices. You should see something like this</p>

<pre><code>Bus 001 Device 002: ID 0424:9512 Standard Microsystems Corp. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. 
Bus 001 Device 004: ID 12d1:1f01 Huawei Technologies Co., Ltd. 
</code></pre>

<p>The last line here comes from our E303. And the <code>1f01</code> (the second part of the ID) tells us, it's in the wrong mode. <code>14db</code> is what we'd like to see here.</p>

<p>Luckily there's <a href="http://www.draisberghof.de/usb_modeswitch/">usb_modeswitch</a>. As it's name suggests, it does exactly what we need: it switches our E303 into network-interface mode. It needs a few packages, so let's install those first.</p>

<div class="highlight highlight-sh"><pre>sudo apt-get install libusb-1.0-0 libusb-1.0-0-dev</pre></div>

<p>I do recommend building it form source to get the latest version. You can do that by running the following commands</p>

<div class="highlight highlight-sh"><pre>mkdir usb_modeswitch
<span class="nf">cd</span> usb_modeswitch/
wget http://www.draisberghof.de/usb_modeswitch/usb-modeswitch-2.2.0.tar.bz2
wget http://www.draisberghof.de/usb_modeswitch/usb-modeswitch-data-20140529.tar.bz2
tar -jxvf usb-modeswitch-2.2.0.tar.bz2
tar -jxvf usb-modeswitch-data-20140529.tar.bz2
<span class="nf">cd</span> usb-modeswitch-2.2.0/
sudo make install
<span class="nf">cd</span> ../usb-modeswitch-data-20140529/
sudo make install</pre></div>

<p>After that do a reboot with <code>sudo reboot</code> and check <code>lsusb</code> again. You should now see the E303 with the correct ID.</p>

<pre><code>Bus 001 Device 005: ID 12d1:14db Huawei Technologies Co., Ltd. 
</code></pre>

<p>Also, when you run <code>ifconfig</code> there should be a second network interface <code>eth1</code> available. If that's the case, the tricky part is done.</p>

<p>However, we still need to edit the interfaces file:</p>

<div class="highlight highlight-sh"><pre>sudo nano /etc/network/interfaces</pre></div>

<p>Copy &amp; paste the following line in:</p>

<pre><code>iface eth1 inet dhcp
</code></pre>

<p>After yet another reboot, the Pi should get an IP address from the E303. If your home network (for ssh access) is also a 192.168.1.0 network you could now get trouble, since the Huawei Stick also uses that network.</p>

<p>PGPager assumes that the E303 doesn't ask for a PIN Code and it auto-connects to the internet. You can configure this settings from the E303's web interface (just plug it into your Computer).</p>

<h3>
<a id="install-necessary-packages" class="anchor" href="#install-necessary-packages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install necessary packages</h3>

<p>PGPager needs a few packages installed. I assume that you are running Raspbian and therefore list only those which are not already included.</p>

<h4>
<a id="install-pip" class="anchor" href="#install-pip" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install PIP</h4>

<p><a href="https://pypi.python.org/pypi/pip">PIP</a> is a tool for installing and managing Python packages. To install it, use the following commands on your Pi</p>

<div class="highlight highlight-sh"><pre>wget https://raw.github.com/pypa/pip/master/contrib/get-pip.py
sudo python get-pip.py</pre></div>

<h4>
<a id="install-python-gnupg" class="anchor" href="#install-python-gnupg" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install python-gnupg</h4>

<p>It's now quite easy to install <a href="https://pythonhosted.org/python-gnupg/">python-gnupg</a>. You could just run <code>sudo pip install python-gnupg</code>.</p>

<p>However, you need at least version 0.3.7 because PGPager uses some features added in this version. At this point in time, you can only get it from the <a href="https://bitbucket.org/vinay.sajip/python-gnupg/">python-gnupg BitBucket Project</a>. To install from most recent sources, run</p>

<div class="highlight highlight-sh"><pre>sudo apt-get install mercurial
hg clone https://bitbucket.org/vinay.sajip/python-gnupg
<span class="nf">cd</span> python-gnupg/
sudo python setup.py install
python test_gnupg.py</pre></div>

<p>The last command is for testing the installation and might take a while... You can skip that if you don't want to wait.</p>

<p>After that you can verify that you got the correct version by typing</p>

<div class="highlight highlight-sh"><pre>pip list <span class="o">|</span> grep gnupg</pre></div>

<p>This should give you <code>python-gnupg (0.3.7.dev0)</code></p>

<h4>
<a id="install-requests" class="anchor" href="#install-requests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install requests</h4>

<p>Thanks to pip, that's very easy</p>

<div class="highlight highlight-sh"><pre>sudo pip install requests</pre></div>

<h4>
<a id="install-open-sans-font" class="anchor" href="#install-open-sans-font" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install Open Sans font</h4>

<p>Download and install by running the following commands</p>

<div class="highlight highlight-sh"><pre>wget --content-disposition http://www.fontsquirrel.com/fonts/download/open-sans
unzip open-sans.zip <span class="o">*</span>.ttf -d open-sans
sudo mv open-sans /usr/share/fonts/truetype/open</pre></div>

<h3>
<a id="run-pgpager" class="anchor" href="#run-pgpager" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run PGPager</h3>

<p>Clone the repository</p>

<div class="highlight highlight-sh"><pre><span class="nf">cd</span> <span class="o">~</span>/
git clone https://github.com/ByteFex/PGPager</pre></div>

<p>start the script</p>

<div class="highlight highlight-sh"><pre><span class="nf">cd</span> PGPager
sudo python pisms.py</pre></div>

<p>and have fun!</p>

<h2>
<a id="run-pgpager-on-startup" class="anchor" href="#run-pgpager-on-startup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run PGPager on startup</h2>

<p>Maybe you want PGPager to start automatically when you boot your Pi. With <a href="http://www.gnu.org/software/screen/">GNU screen</a>, that's easy.</p>

<p>We first need to make the startup-script executable.</p>

<div class="highlight highlight-sh"><pre><span class="nf">cd</span> <span class="o">~</span>/PGPager
chmod +x start_pisms</pre></div>

<p>Then install screen</p>

<div class="highlight highlight-sh"><pre>sudo apt-get install screen</pre></div>

<p>and finally edit <code>rc.local</code></p>

<div class="highlight highlight-sh"><pre>sudo nano /etc/rc.<span class="k">local</span></pre></div>

<p>Add the following line before <code>exit 0</code></p>

<div class="highlight highlight-sh"><pre>su - pi -c <span class="s2">"screen -dm -S pisms ~/PiSMS/start_pisms"</span></pre></div>

<p>You can even take over the session and view debug-output when you ssh into your Pi after PGPager has started. To do that, use the command</p>

<div class="highlight highlight-sh"><pre>screen -DR</pre></div>

<p>If you want even more (or different) screen awesomeness, there is a nice <a href="http://www.gnu.org/software/screen/manual/screen.html">documentation</a>.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>Owner: ByteFex Langkamp-IT e.U.</p>

<p><a href="http://www.gnu.org/licenses/gpl-2.0.txt">GNU General Public License</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ByteFex">ByteFex</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>